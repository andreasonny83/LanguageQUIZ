<!--
@license
Copyright (c) 2015 LanguageQUIZ. All rights reserved.
-->
<script src="../bower_components/page/page.js"></script>

<script>
;( function( global, document ) {
'use strict';

global.addEventListener( 'AppReady', function() {

  // Middleware
  function scrollToTop() {
    document.querySelector( '#mainContainer' ).scrollTop = 0;
  }

  page( '/', function () {
    global.LQ.lqMain.selected = 0;
    page.redirect( '/login' );
    scrollToTop();
  });

  page( '/login', function () {
    // If the user is aleady logged in, redirect to the home page
    if (
      global.LQ.lqMain.$.firebaseLogin &&
      global.LQ.lqMain.$.firebaseLogin.statusKnown &&
      global.LQ.lqMain.$.firebaseLogin.user &&
      global.LQ.lqMain.$.firebaseLogin.user.uid ) {
        page( '/home' );
    }
    else {
      global.LQ.lqMain.selected = 0;
      global.LQ.lqLogin.resetFields();
    }

    scrollToTop();
  });

  page( '/home', function () {
    global.LQ.lqMain.selected = 1;
    global.LQ.lqHome.refreshFilter();
    // page.redirect( '/collections/-K3LCKXLPIb_xQDnQibI' );
    scrollToTop();
  });

  page( '/profile', function () {
    global.LQ.lqMain.selected = 2;
    global.LQ.lqUserProfile.reset();
    global.LQ.lqUserProfile.querySelector( '#mainContainer' ).scrollTop = 0;
  });

  page( '/new-collection', function () {
    global.LQ.lqMain.selected = 3;
    global.LQ.lqUserCollection.init();
    global.LQ.lqUserCollection.querySelector( '#mainContainer' ).scrollTop = 0;
  });

  page( '/collections/:uid', function ( uid ) {
    global.LQ.lqCollectionEdit.dataReady = false;
    global.LQ.lqCollectionEdit.init( uid );
    global.LQ.lqMain.selected = 4;
    global.LQ.lqCollectionEdit.querySelector( '#mainContainer' ).scrollTop = 0;
  });

  page( '*', function () {
    page.redirect( '/login' );
    scrollToTop();
  });

  page({
    hashbang: true
  });

});
}( typeof window !== undefined ? window : this, document ));
</script>
