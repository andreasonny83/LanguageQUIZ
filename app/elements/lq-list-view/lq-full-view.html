<!--
@license
Copyright (c) 2015 LanguageQUIZ. All rights reserved.
-->
<dom-module id="lq-full-view">

  <style>

    :host {
      position: fixed;
      display: none;
      width: 50%;
      height: 50%;
      top: 320px;
      padding: 16px;
      background: white;
      color: black;

      @apply(--layout-center);
      @apply(--shadow-elevation-16dp);
    }

    paper-button.done {
      color: var(--paper-green-500);
      --paper-button-flat-focus-color: var(--paper-green-50);

    }
    paper-button.done:hover {
      background: var(--paper-green-50);
    }

    paper-button.cancel {
      color: var(--paper-red-500);
      --paper-button-flat-focus-color: var(--paper-red-50);
    }

    paper-button.cancel:hover {
      background: var(--paper-red-50);
    }

  </style>

  <template>

    <div class="vertical-section">
      <paper-input-suggestions max-suggestions="3" local-suggestions="{{suggestions_a}}" input-value="{{value_a}}" placeholder="Word in English"></paper-input-suggestions>
      <paper-input-suggestions max-suggestions="3" local-suggestions="{{suggestions_b}}" input-value="{{value_b}}" placeholder="Word in Italian"></paper-input-suggestions>

      <div class="horizontal-section-container">
        <paper-button class="cancel" on-click="hide">
          <iron-icon icon="close"></iron-icon>
          Cancel
        </paper-button>
        <paper-button class="done" on-click="hide">
          <iron-icon icon="done"></iron-icon>
          Ok
        </paper-button>
      </div>
    </div>

    <firebase-collection
      id="lqWordsA"
      location="[[lqLocationWordsA]]"
      data="{{words_a}}"></firebase-collection>
    <firebase-collection
      id="lqWordsB"
      location="[[lqLocationWordsB]]"
      data="{{words_b}}"></firebase-collection>

  </template>

</dom-module>

<script>

  Polymer({

    is: 'lq-full-view',

    behaviors: [
      Polymer.NeonAnimationRunnerBehavior
    ],

    properties: {

      animationConfig: {
        type: Object,
        value: function() {
          return {
            'entry': [{
              name: 'slide-down-animation',
              node: this
            }],
            'exit': [{
              name: 'fade-out-animation',
              node: this
            }]
          };
        }
      },

      _showing: {
        type: Boolean,
        value: false
      },

      lqLocationWordsA: {
        type: String,
        value: 'https://languagequiz-dev.firebaseio.com/languages/ads9ufdsf8f9ufs/words'
      },

      lqLocationWordsB: {
        type: String,
        value: 'https://languagequiz-dev.firebaseio.com/languages/asd98ads9uasd/words'
      },

      suggestions_a: {
        type: Array,
        value: function() {
          return [];
        }
      },

      suggestions_b: {
        type: Array,
        value: function() {
          return [];
        }
      },

      language: {
        type: String,
        value: 'English'
      },

      value_a: {
        type: String,
        value: 'English'
      }

    },

    observers: [
      'prepareSuggestions(searchString.*)'
    ],

    listeners: {
      'neon-animation-finish': '_onAnimationFinish'
    },

    /**
     * Based on the paper-typeahead-input in where the user has typed,
     * trigger a displaySuggestions to display the words suggested.
     *
     * @param  [Object] input The input in where the user has typed the word
     */
    prepare: function() {
      this.createSuggestions( this.words_a, this.suggestions_a );
      this.createSuggestions( this.words_b, this.suggestions_b );
    },

    /**
     * Animate this component using neon-animations
     * @return {[type]} [description]
     */
    _onAnimationFinish: function() {
      if (this._showing) {
      } else {
        this.style.display = '';
      }
    },

    show: function() {
      this.style.display = 'inline-block';
      this._showing = true;
      this.playAnimation('entry');
    },

    hide: function() {
      this._showing = false;
      this.playAnimation('exit');
    },

    /**
     * Populate the suggestions with the possible related words to suggest
     * and display the results inside the correspondent paper-typeahead-input
     *
     * @param  [Object] language_words The list of words fetched from the database
     * @param  [String] input          The word typed by the user inside the paper-typeahead-input
     */
    createSuggestions: function( language_words, suggestions ) {
      for ( var key in language_words ) {
        suggestions.push( language_words[key].name );
      }
    },

    addWord: function() {
      console.log(this.sonny);
    }

  });

</script>
